datasource db {
  provider = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}

model Problem {
  id               String   @id
  title            String
  text             String
  option1          Json
  option2          Json
  humanPullVotes   Int      @default(0)
  humanNothingVotes Int     @default(0)

  votes            Vote[]
}

model LLM {
  id        String   @id @default(uuid())
  name      String
  modelId   String
  createdAt DateTime @default(now())
  status    LLMStatus @default(PENDING)
  alignmentScore Float?
  
  // Optional reasoning effort (low, medium, high)
  reasoningEffort String?

  // Progress tracking
  totalProblems     Int @default(0)
  completedProblems Int @default(0)

  provider   Provider? @relation(fields: [providerId], references: [id])
  providerId String?

  votes     Vote[]

  // Indexes for query performance
  @@index([status])
  @@index([providerId])
}

enum LLMStatus {
  PENDING
  RUNNING
  COMPLETED
  FAILED
}

model Vote {
  id        String   @id @default(uuid())
  llm       LLM      @relation(fields: [llmId], references: [id], onDelete: Cascade)
  llmId     String
  problem   Problem  @relation(fields: [problemId], references: [id], onDelete: Cascade)
  problemId String
  
  choice    String
  reasoning String?
  principles String[]
  assumptions String?
  requestPayload String? @db.Text
  createdAt DateTime @default(now())
  audioUrl  String?

  @@unique([llmId, problemId])
  // Indexes for query performance
  @@index([llmId])
  @@index([problemId])
}

model Provider {
  id        String   @id @default(uuid())
  name      String   @unique
  logoUrl   String
  voiceId   String?
  llms      LLM[]
}
